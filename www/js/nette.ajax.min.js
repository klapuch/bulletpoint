!function(t,e,n){if("function"!=typeof e)return console.error("nette.ajax.js: jQuery is missing, load it please");var i=function(){var t={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var i=!0,o=Array.prototype.slice.call(arguments),r=o.shift(),a="string"==typeof r?r:r.name,f="object"==typeof r?r.off||{}:{};return o.push(t.self),e.each(t.on[a],function(r,a){if(a===n||-1!==e.inArray(r,f))return!0;var s=a.apply(t.contexts[r],o);return i=s===n||s}),i},requestHandler:function(e){!t.self.ajax({},this,e)},ext:function(i,o,r){for(;!r;)r="ext_"+Math.random(),t.contexts[r]&&(r=n);e.each(i,function(e,n){t.on[e][r]=n}),t.contexts[r]=e.extend(o?o:{},{name:function(){return r},ext:function(e,n){var i=t.contexts[e];if(!i&&n)throw"Extension '"+this.name()+"' depends on disabled extension '"+e+"'.";return i}})}};this.ext=function(i,o,r){if("object"==typeof i)t.ext(i,o);else{if(o===n)return t.contexts[i];if(o){if("string"==typeof i&&t.contexts[i]!==n)throw"Cannot override already registered nette-ajax extension '"+i+"'.";t.ext(o,r,i)}else e.each(["init","load","prepare","before","start","success","complete","error"],function(e,o){t.on[o][i]=n}),t.contexts[i]=n}return this},this.init=function(e,i){if(t.initialized)throw"Cannot initialize nette-ajax twice.";if("function"==typeof e)this.ext("init",null),this.ext("init",{load:e},i);else if("object"==typeof e)this.ext("init",null),this.ext("init",e,i);else if(e!==n)throw"Argument of init() can be function or function-hash only.";return t.initialized=!0,t.fire("init"),this.load(),this},this.load=function(){return t.fire("load",t.requestHandler),this},this.ajax=function(i,o,r){if(!i.nette&&o&&r){var a,f,s=e(o),u=i.nette={e:r,ui:o,el:s,isForm:s.is("form"),isSubmit:s.is("input[type=submit]")||s.is("button[type=submit]"),isImage:s.is("input[type=image]"),form:null};u.isSubmit||u.isImage?u.form=u.el.closest("form"):u.isForm&&(u.form=u.el),i.url||(i.url=u.form?u.form.attr("action"):o.href),i.type||(i.type=u.form?u.form.attr("method"):"get"),s.is("[data-ajax-off]")&&(i.off=s.data("ajaxOff"),"string"==typeof i.off&&(i.off=[i.off]))}return t.fire({name:"prepare",off:i.off||{}},i),i.prepare&&i.prepare(i),f=i.beforeSend,i.beforeSend=function(e,i){if(f){var o=f(e,i);if(o!==n&&!o)return o}return t.fire({name:"before",off:i.off||{}},e,i)},a=e.ajax(i),!a||"undefined"!=typeof a.statusText&&"canceled"===a.statusText||(a.done(function(e,n,o){t.fire({name:"success",off:i.off||{}},e,n,o)}).fail(function(e,n,o){t.fire({name:"error",off:i.off||{}},e,n,o)}).always(function(e,n){t.fire({name:"complete",off:i.off||{}},e,n)}),t.fire({name:"start",off:i.off||{}},a,i),i.start&&i.start(a,i)),a}};e.nette=new(e.extend(i,e.nette?e.nette:{})),e.fn.netteAjax=function(t,n){return e.nette.ajax(n||{},this[0],t)},e.fn.netteAjaxOff=function(){return this.off(".nette")},e.nette.ext("validation",{before:function(t,i){if(!i.nette)return!0;var o=i.nette,r=o.e,a=e.extend({keys:!0,url:!0,form:!0},i.validate||function(){if(o.el.is("[data-ajax-validate]")){var t=o.el.data("ajaxValidate");return t===!1?{keys:!1,url:!1,form:!1}:"object"==typeof t?t:void 0}}()||{}),f=!1;if(o.el.attr("data-ajax-pass")!==n&&(f=o.el.data("ajaxPass"),f="bool"==typeof f?f:!0),a.keys){var s=r.button||r.ctrlKey||r.shiftKey||r.altKey||r.metaKey;if(o.form){if(s&&o.isSubmit)return this.explicitNoAjax=!0,!1;if(o.isForm&&this.explicitNoAjax)return this.explicitNoAjax=!1,!1}else if(s)return!1}return a.form&&o.form&&(!o.isSubmit&&!o.isImage||o.el.attr("formnovalidate")===n)&&o.form.get(0).onsubmit&&o.form.get(0).onsubmit()===!1?(r.stopImmediatePropagation(),r.preventDefault(),!1):a.url&&/:|^#/.test(o.form?i.url:o.el.attr("href"))?!1:(f||(r.stopPropagation(),r.preventDefault()),!0)}},{explicitNoAjax:!1}),e.nette.ext("forms",{init:function(){var e;t.Nette&&(e=this.ext("snippets"))&&e.after(function(e){e.find("form").each(function(){t.Nette.initForm(this)})})},prepare:function(t){var n=t.nette;if(n&&n.form){var i=n.e,o=t.data||{},r={};if(n.isSubmit)r[n.el.attr("name")]=n.el.val()||"";else if(n.isImage){var a=n.el.offset(),f=n.el.attr("name"),s=[Math.max(0,i.pageX-a.left),Math.max(0,i.pageY-a.top)];-1!==f.indexOf("[",0)?r[f]=s:(r[f+".x"]=s[0],r[f+".y"]=s[1])}"string"!=typeof o&&(o=e.param(o)),r=e.param(r),t.data=n.form.serialize()+(r?"&"+r:"")+"&"+o}}}),e.nette.ext("snippets",{success:function(t){var n=[];if(t.snippets)for(var i in t.snippets){var o=this.getElement(i);e.each(this.beforeQueue,function(t,e){"function"==typeof e&&e(o)}),this.updateSnippet(o,t.snippets[i]),e.each(this.afterQueue,function(t,e){"function"==typeof e&&e(o)})}this.before(n)}},{beforeQueue:[],afterQueue:[],before:function(t){this.beforeQueue.push(t)},after:function(t){this.afterQueue.push(t)},updateSnippet:function(t,e,n){"string"==typeof t&&(t=this.getElement(t)),t.is("title")?document.title=e:this.applySnippet(t,e,n)},getElement:function(t){return e("#"+this.escapeSelector(t))},applySnippet:function(t,e,n){!n&&t.is("[data-ajax-append]")?t.append(e):t.html(e)},escapeSelector:function(t){return t.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}}),e.nette.ext("redirect",{success:function(e){return e.redirect?(t.location.href=e.redirect,!1):void 0}}),e.nette.ext("state",{success:function(t){t.state&&(this.state=t.state)}},{state:null}),e.nette.ext("unique",{start:function(t){this.xhr&&this.xhr.abort(),this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),e.nette.ext("abort",{init:function(){e("body").keydown(e.proxy(function(t){this.xhr&&27==t.keyCode&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&this.xhr.abort()},this))},start:function(t){this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),e.nette.ext("load",{success:function(){e.nette.load()}}),e.nette.ext("init",{load:function(t){e(this.linkSelector).off("click.nette",t).on("click.nette",t),e(this.formSelector).off("submit.nette",t).on("submit.nette",t).off("click.nette",":image",t).on("click.nette",":image",t).off("click.nette",":submit",t).on("click.nette",":submit",t),e(this.buttonSelector).closest("form").off("click.nette",this.buttonSelector,t).on("click.nette",this.buttonSelector,t)}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]'})}(window,window.jQuery),$(function(){$.nette.init()});